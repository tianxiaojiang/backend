<script type="text/html" template lay-url="/admin/common/game-stats" lay-done="getGameStatCallback(d);">
    <div class="layui-fluid">
        <form class="layui-form" action="">
            <div class="layui-form-item">
                <label class="layui-form-label">游戏类型</label>
                <div class="layui-input-block">
                    <select name="game_type" id="add-game-game_type" required lay-verify="required">
                        <option value="0">端游</option>
                        <option value="1">手游</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">游戏ID</label>
                <div class="layui-input-block"><input type="text" name="game_id" required  lay-verify="required" placeholder="游戏ID" autocomplete="off" class="layui-input" /></div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">游戏名</label>
                <div class="layui-input-block"><input type="text" name="name" required  lay-verify="required" placeholder="游戏名" autocomplete="off" class="layui-input" /></div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">英文代号</label>
                <div class="layui-input-block"><input type="text" name="alias" placeholder="英文代号" autocomplete="off" class="layui-input" /></div>
            </div>
            <div class="layui-form-item">
            <label class="layui-form-label">状态</label>
            <div class="layui-input-block">
                <select name="status" id="add-game-status" required lay-verify="required">
                </select>
            </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit="" lay-filter="add-game">提交</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </form>
    </div>
</script>
<script>
var getGameStatCallback = function(d) {
    layui.use(['table', 'laytpl', 'form', 'ztutil', 'admin', 'view'], function () {

        var $ = layui.jquery, table = layui.table, form = layui.form, laytpl = layui.laytpl, ztutil = layui.ztutil, admin = layui.admin, view = layui.view;

        var renderStat = function(){
            console.log(d);
            var statSelectHtml = '';
            $.each(d.data.stats, function (k, v) {
                statSelectHtml += '<option value="'+ k +'">'+ v +'</option>';
            });
            $('#add-game-status').html(statSelectHtml);
            form.render();
        }
        renderStat();

        // 提交添加角色按钮
        form.on('submit(add-game)', function (data) {
            var options = {
                data: data.field,
                url: '/admin/game/create',
                method: 'post',
                done: function () {
                    layer.closeAll();
                    table.reload('system-game');
                    layer.msg('添加游戏成功！');
                }
            };
            admin.req(options);
            return false;
        });

    });
}
</script>