# 通过协议对接

具体步骤如下：

## 第一、申请系统接入：

#### 需要准备的资料
- 系统名称（示例：IDIP）
- 系统URL（示例：http://www.baidu.com）
- 授权回调地址（示例：/user/auth 或者 /auth.html 等）
- 管理游戏类型（端游或手游或不区分游戏）
- 负责人工号
- 简要描述（非必须）
- icon两张（一张透明、一张高亮。示例：http://unify-admin.sdk.mobileztgame.com）

#### 申请方式

将准备好的资料，发送邮件给俞然、高红明，抄送田卫民。

#### 技术对接人

田卫民

## 第二、数据准备

开发人员，在登录页面（http://unify-admin.sdk.mobileztgame.com）。

#### 测试地址
192.168.39.75 unify-admin.sdk.mobileztgame.com

点击 -> 右上角管理后台 -> 对应子系统 -> 进入权限管理页面：

可以设置以下功能：

#### 设置管理的游戏(若子系统区分游戏)

由于系统要管理的游戏可能不一样，所以你需要先设置系统要管理哪些游戏。

#### 菜单
> 注意点：
菜单也分了两种。
- 一种是管理后台的，是给开发人员和管理人员使用(在管理后台功能升级时，使用)；
- 一种是业务后台的，是给运营人员使用的。

刚开始只有系统设置这一个根菜单(先别动他)。
你需要添加一个或多个根业务菜单，然后在下面继续添加子菜单。

> 需要说明的是，字段【前端地址】是另一种后台demo需要的。你可以利用此字段，来打开不同对应页面。
> 菜单的顺序以及父子关系，可以拖动菜单图标来修改。

#### 权限

所有的业务权限，都需要附注到一个菜单下，以便于管理。比如一个新闻管理菜单下，可能有```添加新闻```、```修改新闻```等权限。

权限也分两种:
- 第一种是拥有菜单的权限。这种权限的module/controller/action均填写main即可。通过此权限来，控制用户进入时，显示的菜单。
- 第二种是操作权限。这时候module/controller/action对应的就是你的操作。

具体样例，进入后台后，可以参考已经有的数据。

#### 角色
比较简单，进入后台后，操作一下就会了。

注意点：
1. 开发人员，不受角色权限的控制。
2. 权限只能降权，无法提权。也就是一个管理员，不是开发人员，但拥有管理角色的权限，他添加或修改角色时，只能修改他已有的权限。

#### 运营人员
比较简单，进入后台，操作一下就会了。

## 接口文档

> 接口统一地址：http://unify-admin.sdk.mobileztgame.com

#### 接口列表
- [获取token](./doc_source/getToken.md)
- [游戏列表](./doc_source/gameList.md)
- [菜单列表](./doc_source/gameMenus.md)
- [鉴定单个权限](./doc_source/verify.md)
- [查询操作有无权限](./doc_source/checkPrivilege.md)


接口错误码处理：

返回code为0，表示鉴权成功

| code码 | 说明 | 处理 |
| --- | --- | --- |
| 0 | 鉴权成功 | 可以执行后续操作 |
| 4102 | 没有权限 | 提示用户去开通权限 |
| 4098 | token失效 | 提示用户重新登录，页面跳转到登录页 |

其他错误，均可提示即可，无特殊逻辑处理。


















